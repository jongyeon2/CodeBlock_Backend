plugins {
    id 'java'
    id 'org.springframework.boot' version '3.3.4'
    id 'io.spring.dependency-management' version '1.1.6'
    id 'org.flywaydb.flyway' version '10.18.2'
}

group = 'com.studyblock'
version = '0.0.1-SNAPSHOT'

java {
    sourceCompatibility = '17'
    targetCompatibility = '17'
}

configurations {
    compileOnly {
        extendsFrom annotationProcessor
    }
}

repositories {
    mavenCentral()
}

dependencies {
    // ===========================================
    // ğŸš€ Spring Boot Core Starters
    // ===========================================
    
    // Spring Boot Web (REST API ê°œë°œ)
    implementation 'org.springframework.boot:spring-boot-starter-web'
    
    // Spring Boot WebSocket (ì‹¤ì‹œê°„ í†µì‹ )
    //implementation 'org.springframework.boot:spring-boot-starter-websocket'
    
    // Spring Boot Validation (ë°ì´í„° ê²€ì¦)
    implementation 'org.springframework.boot:spring-boot-starter-validation'
    
    // Spring Boot Actuator (ëª¨ë‹ˆí„°ë§ ì—”ë“œí¬ì¸íŠ¸)
    implementation 'org.springframework.boot:spring-boot-starter-actuator'
    
    // Spring Boot DevTools (ê°œë°œ í¸ì˜ ë„êµ¬)
    developmentOnly 'org.springframework.boot:spring-boot-devtools'
    
    // Spring Boot Configuration Processor (ì„¤ì • ë©”íƒ€ë°ì´í„°)
    annotationProcessor 'org.springframework.boot:spring-boot-configuration-processor'
    
    // ===========================================
    // ğŸ” Spring Security & OAuth2
    // ===========================================
    
    // Spring Boot Security (ì¸ì¦/ì¸ê°€)
    implementation 'org.springframework.boot:spring-boot-starter-security'
    
    // OAuth2 Resource Server (SNS ë¡œê·¸ì¸ ëŒ€ë¹„)
    implementation 'org.springframework.boot:spring-boot-starter-oauth2-resource-server'
    
    // ===========================================
    // ğŸ—„ï¸ Database & JPA (ì„ì‹œ ë¹„í™œì„±í™” - ìŠ¤í‚¤ë§ˆ ìƒì„± í›„ í™œì„±í™”)
    // ===========================================
    
    // Spring Boot Data JPA (ORM) - ì„ì‹œ ë¹„í™œì„±í™”
     implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    
    // MySQL Connector (MySQL 8.0+ í˜¸í™˜) - ì„ì‹œ ë¹„í™œì„±í™”
     runtimeOnly 'com.mysql:mysql-connector-j'
    
    // Flyway (ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜) - ì„ì‹œ ë¹„í™œì„±í™”
     implementation 'org.flywaydb:flyway-core'
     implementation 'org.flywaydb:flyway-mysql'
    
    // ===========================================
    // ğŸ” Monitoring & Documentation
    // ===========================================
    
    // Spring Boot Admin Client (3.3.4 - JDK 17 ì•ˆì • ë²„ì „)
    implementation 'de.codecentric:spring-boot-admin-starter-client:3.3.4'
    
    // SpringDoc OpenAPI (2.5.0)
    implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.5.0'
    
    // ===========================================
    // ğŸ”‘ JWT Authentication
    // ===========================================
    
    // JJWT API (0.12.6 - í´ë¡œë“œ ì¶”ì²œ ìµœì‹  ì•ˆì • ë²„ì „)
    implementation 'io.jsonwebtoken:jjwt-api:0.12.6'
    
    // JJWT Implementation (0.12.6 - ìµœì‹  ì•ˆì • ë²„ì „)
    runtimeOnly 'io.jsonwebtoken:jjwt-impl:0.12.6'
    
    // JJWT Jackson (0.12.6 - JSON ì²˜ë¦¬)
    runtimeOnly 'io.jsonwebtoken:jjwt-jackson:0.12.6'
    
    // ===========================================
    // ğŸ› ï¸ Development Tools
    // ===========================================
    
    // Lombok (ì½”ë“œ ê°„ì†Œí™” - ìµœì‹  ì•ˆì • ë²„ì „)
    compileOnly 'org.projectlombok:lombok'
    annotationProcessor 'org.projectlombok:lombok'
    
    // MapStruct (ë§¤í•‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ - í–¥í›„ ì‚¬ìš© ê°€ëŠ¥)
    // implementation 'org.mapstruct:mapstruct:1.5.5.Final'
    // annotationProcessor 'org.mapstruct:mapstruct-processor:1.5.5.Final'
    
    // ===========================================
    // ğŸ§ª Testing
    // ===========================================
    
    // Spring Boot Test
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    
    // Spring Security Test
    testImplementation 'org.springframework.security:spring-security-test'
    
    // JUnit Platform Launcher
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
    
    // TestContainers (í†µí•© í…ŒìŠ¤íŠ¸ìš© - í–¥í›„ ì‚¬ìš© ê°€ëŠ¥)
    // testImplementation 'org.testcontainers:junit-jupiter'
    // testImplementation 'org.testcontainers:mysql'
    
    // ===========================================
    // ğŸ”® í–¥í›„ ì¶”ê°€ ê°€ëŠ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ (ì£¼ì„ ì²˜ë¦¬)
    // ===========================================

    // QueryDSL
    implementation 'com.querydsl:querydsl-jpa:5.0.0:jakarta'
    annotationProcessor 'com.querydsl:querydsl-apt:5.0.0:jakarta'
    annotationProcessor 'jakarta.annotation:jakarta.annotation-api'
    annotationProcessor 'jakarta.persistence:jakarta.persistence-api'
    // Redis (ìºì‹±)
     implementation 'org.springframework.boot:spring-boot-starter-data-redis'
    
    
    // Mail (ì´ë©”ì¼ ë°œì†¡)
     implementation 'org.springframework.boot:spring-boot-starter-mail'
    
    // Thymeleaf (ì„œë²„ì‚¬ì´ë“œ í…œí”Œë¦¿)
    // implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    
    // Quartz (ìŠ¤ì¼€ì¤„ë§)
    // implementation 'org.springframework.boot:spring-boot-starter-quartz'
    
    // Spring Cloud (ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤)
    // implementation 'org.springframework.cloud:spring-cloud-starter-netflix-eureka-client'
    
    // Micrometer (ë©”íŠ¸ë¦­ ìˆ˜ì§‘)
    // implementation 'io.micrometer:micrometer-registry-prometheus'
    
    // Apache Commons (ìœ í‹¸ë¦¬í‹°)
    // implementation 'org.apache.commons:commons-lang3'
    // implementation 'commons-io:commons-io'

    // AWS ì„¤ì •
    implementation platform("io.awspring.cloud:spring-cloud-aws-dependencies:3.2.0")
    implementation 'io.awspring.cloud:spring-cloud-aws-starter-s3'

    // SNS ë¡œê·¸ì¸
    implementation 'org.springframework.boot:spring-boot-starter-oauth2-client'

    // .env íŒŒì¼ ë¡œë”
    implementation 'me.paulschwarz:spring-dotenv:4.0.0'

    // ===========================================
    // ğŸ’³ í† ìŠ¤í˜ì´ë¨¼ì¸  REST API
    // ===========================================

    // WebClient (í† ìŠ¤í˜ì´ë¨¼ì¸  REST API í˜¸ì¶œìš©)
    implementation 'org.springframework.boot:spring-boot-starter-webflux'

    // Jackson Databind (JSON ì²˜ë¦¬ - ì´ë¯¸ Spring Bootì— í¬í•¨ë˜ì–´ ìˆì§€ë§Œ ëª…ì‹œ)
    // implementation 'com.fasterxml.jackson.core:jackson-databind'

    // Excel ì—…ë¡œë“œ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤
    implementation 'org.apache.poi:poi:5.2.4' // 97-03ë²„ì „(.xls) í˜•ì‹ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬
    implementation 'org.apache.poi:poi-ooxml:5.2.4' // 07~ë²„ì „(.xlsx) í˜•ì‹ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ í™•ì¥ ë¼ì´ë¸ŒëŸ¬ë¦¬
    implementation 'org.apache.poi:poi-scratchpad:5.2.4' // ì¶”ê°€ POI ê¸°ëŠ¥
    implementation 'com.opencsv:opencsv:5.9' // ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„ëœ ê°’ë“¤ì„ ì €ì¥í•˜ëŠ” í˜•ì‹

    // WebP ì§€ì› ë¼ì´ë¸ŒëŸ¬ë¦¬ (ì•ˆì •ì ì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì°¾ì„ ë•Œê¹Œì§€ ì„ì‹œ ë¹„í™œì„±í™”)
    // implementation 'com.github.gotson:webp-imageio:0.1.0'
}

tasks.named('test') {
    useJUnitPlatform()
}

// QueryDSL Qí´ë˜ìŠ¤ ìƒì„± ê²½ë¡œ ì„¤ì •
def querydslDir = "$buildDir/generated/sources/annotationProcessor/java/main"

sourceSets {
    main {
        java {
            srcDirs = ['src/main/java', querydslDir]
        }
    }
}

// QueryDSL annotation processor ì‹¤í–‰
tasks.withType(JavaCompile) {
    options.annotationProcessorPath = configurations.annotationProcessor
    options.annotationProcessorGeneratedSourcesDirectory = file(querydslDir)
}

// clean íƒœìŠ¤í¬ ì‹œ ìƒì„±ëœ Qí´ë˜ìŠ¤ ë””ë ‰í† ë¦¬ ì‚­ì œ
clean {
    delete file(querydslDir)
}

